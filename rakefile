cookbook_dir = 'cookbooks/'

task :default => :clean do
  puts 'Downloading required cookbooks...'
  mkdir cookbook_dir
  `knife cookbook site install varnish --cookbook-path=#{cookbook_dir}`
  `knife cookbook site install apt --cookbook-path=#{cookbook_dir}`
  `knife cookbook site install ark --cookbook-path=#{cookbook_dir}`
  `knife cookbook site install git --cookbook-path=#{cookbook_dir}`
  `knife cookbook site install java --cookbook-path=#{cookbook_dir}`
  `knife cookbook site install maven --cookbook-path=#{cookbook_dir}`
  cloneJenkins(cookbook_dir + 'jenkins/')
end

def cloneJenkins(jenkins_cookbook_dir)
  `mkdir --parents #{jenkins_cookbook_dir}`
  `wget https://gist.github.com/gists/978920/download --output-document=#{jenkins_cookbook_dir}978920.tgz`
  `tar --verbose --extract --directory=#{jenkins_cookbook_dir} --file=#{jenkins_cookbook_dir}978920.tgz`
  `mv #{jenkins_cookbook_dir}gist* #{jenkins_cookbook_dir}recipes/`
  rm_rf jenkins_cookbook_dir + '978920.tgz'
end

task :cloneJenkins => :clean do
  cloneJenkins(cookbook_dir)
end

task :clean do
  puts 'Cleaning cookbooks...'
  rm_rf cookbook_dir
end
